<% if current_user == @user %>
  <% provide(:title, 'マイページ') %>
<% else %>
  <% provide(:title, "#{@user.name}さん") %>
<% end %>

<div class="grid grid-cols-4">
  <div class="user-info col-span-1 container mx-auto">
    <div class="user-image justify-items-center mt-6">
      <%= render 'shared/user_image', user: @user %>
    </div>
    <div class="text-center text-gray-700 text-xl font-bold mt-3">
      <%= @user.name %>
    </div>
    <div class="user-follow text-center m-3">
      <p class="inline-block w-1/3 py-2 mr-3 border border-green-500 bg-green-400 rounded-full hover:bg-green-600 text-white">
        <%=link_to "フォロー中", follows_user_path(@user.id) %>
      </p>
      <p class="inline-block w-1/3 py-2 mr-3 border border-green-500 bg-green-400 rounded-full hover:bg-green-600 text-white">
        <%=link_to "フォロワー", followers_user_path(@user.id) %>
      </p>
    </div>
    <% if current_user != @user %>
      <% if @user.followed_by?(current_user) %>
          <p class="mx-auto w-1/2 text-center py-2 rounded border-2 border-red-500 text-red-500 hover:bg-red-500 hover:text-white mt-3">
            <%=link_to "フォロー解除", user_relationships_path(@user.id), method: :delete %>
          </p>
      <% else %>
          <p class="mx-auto w-1/2 text-center py-2 rounded border-2 border-blue-400 text-blue-400 hover:bg-blue-400 hover:text-white mt-3">
            <%=link_to "フォロー", user_relationships_path(@user.id), method: :post %>
          </p>
      <% end %>
    <%else %>
      <div>
        <div class="text-center flex flex-col">
          <div class="mb-3">
            <%= link_to favorites_user_path,class: "px-3 py-2 rounded border border-gray-200 hover:border-green-500" do %>
              <i class="fas fa-star fa-lg fill-current text-gray-400 mr-2 inline-block"></i>いいねした投稿
            <% end %>
          </div>
          <div class="m-2">
            <%= link_to meal_records_user_path(current_user),class: "px-3 py-2 rounded border border-gray-200 mr-2 hover:border-green-500" do %>
              <i class="far fa-calendar-alt fa-lg fill-current text-gray-400 mr-2 inline-block"></i>食事記録
            <% end %>
            <%= link_to browsing_histories_user_path, class: "px-3 py-2 rounded border border-gray-200 hover:border-green-500" do %>
              <i class="fas fa-history fa-lg fill-current text-gray-400 mr-2 inline-block"></i>閲覧履歴
            <% end %>
          </div>
        </div>
        <div class="text-center">
          <%= link_to 'ユーザー情報編集', edit_user_registration_path, class: "inline-block text-yellow-500 bg-white border border-yellow-500 hover:text-white hover:bg-yellow-500 font-base px-4 py-2 mt-4 rounded text-base" %>
        </div>
      </div>
    <% end %>
  </div>
  <div class="posts-info col-span-3">
    <% if @user.posts.any? %>
      <ol class="posts grid grid-cols-3">
        <%= render @posts %>
      </ol>
      <%= paginate @posts %>
    <% end %>
  </div>
</div>
